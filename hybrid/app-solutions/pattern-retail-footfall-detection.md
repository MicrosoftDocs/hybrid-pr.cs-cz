---
title: Vzor detekce Footfall pomocí Azure a centra Azure Stack
description: Naučte se používat Azure a centrum Azure Stack k implementaci řešení pro detekci Footfall založeného na AI pro analýzu provozu v maloobchodním obchodě.
author: BryanLa
ms.topic: article
ms.date: 10/31/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 10/31/2019
ms.openlocfilehash: 866557ec3af2337e9f034da84cf417675508563b
ms.sourcegitcommit: 962334135b63ac99c715e7bc8fb9282648ba63c9
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/23/2021
ms.locfileid: "104895325"
---
# <a name="footfall-detection-pattern"></a><span data-ttu-id="24c19-103">Model detekce Footfall</span><span class="sxs-lookup"><span data-stu-id="24c19-103">Footfall detection pattern</span></span>

<span data-ttu-id="24c19-104">Tento model poskytuje přehled implementace řešení detekce Footfall založených na AI pro analýzu provozu návštěvníků v prodejnách.</span><span class="sxs-lookup"><span data-stu-id="24c19-104">This pattern provides an overview for implementing an AI-based footfall detection solution for analyzing visitor traffic in retail stores.</span></span> <span data-ttu-id="24c19-105">Řešení generuje přehledy z reálných akcí, pomocí Azure, centra Azure Stack a Custom Vision AI pro vývojáře.</span><span class="sxs-lookup"><span data-stu-id="24c19-105">The solution generates insights from real world actions, using Azure, Azure Stack Hub, and the Custom Vision AI Dev Kit.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="24c19-106">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="24c19-106">Context and problem</span></span>

<span data-ttu-id="24c19-107">Obchody společnosti Contoso by chtěli získat přehled o tom, jak zákazníci dostávají své aktuální produkty ve vztahu k uložení rozložení.</span><span class="sxs-lookup"><span data-stu-id="24c19-107">Contoso Stores would like to gain insights on how customers are receiving their current products in relation to store layout.</span></span> <span data-ttu-id="24c19-108">Nemůžou do každého oddílu umístit pracovníky a je neefektivní, aby tým analytiků provedl kontrolu celého záběru na kameře v celém úložišti.</span><span class="sxs-lookup"><span data-stu-id="24c19-108">They're unable to place staff in every section and it's inefficient to have a team of analysts review an entire store's camera footage.</span></span> <span data-ttu-id="24c19-109">Kromě toho žádný z jejich úložišť nemá dostatek šířky pásma pro streamování videa ze všech kamer do cloudu pro účely analýzy.</span><span class="sxs-lookup"><span data-stu-id="24c19-109">In addition, none of their stores have enough bandwidth to stream video from all their cameras to the cloud for analysis.</span></span>

<span data-ttu-id="24c19-110">Společnost Contoso by chtěla najít nenáročné a uživatelsky přívětivý způsob, jak určit demografické údaje zákazníků, věrnostní věci a reakce na ukládání a zobrazování produktů.</span><span class="sxs-lookup"><span data-stu-id="24c19-110">Contoso would like to find an unobtrusive, privacy-friendly way to determine their customers' demographics, loyalty, and reactions to store displays and products.</span></span>

## <a name="solution"></a><span data-ttu-id="24c19-111">Řešení</span><span class="sxs-lookup"><span data-stu-id="24c19-111">Solution</span></span>

<span data-ttu-id="24c19-112">Tento vzor maloobchodní analýzy používá vrstvený přístup k Inferencing na hranici.</span><span class="sxs-lookup"><span data-stu-id="24c19-112">This retail analytics pattern uses a tiered approach to inferencing at the edge.</span></span> <span data-ttu-id="24c19-113">Pomocí Custom Vision AI dev Kit se k analýze odesílají jenom obrázky s lidskými obličejemi do privátního centra Azure Stack, na kterém běží Azure Cognitive Services.</span><span class="sxs-lookup"><span data-stu-id="24c19-113">By using the Custom Vision AI Dev Kit, only images with human faces are sent for analysis to a private Azure Stack Hub that runs Azure Cognitive Services.</span></span> <span data-ttu-id="24c19-114">Anonymní agregovaná data se do Azure odešlou pro agregaci napříč všemi obchody a vizualizací v Power BI.</span><span class="sxs-lookup"><span data-stu-id="24c19-114">Anonymized, aggregated data is sent to Azure for aggregation across all stores and visualization in Power BI.</span></span> <span data-ttu-id="24c19-115">Kombinování hraničního a veřejného cloudu umožňuje společnosti Contoso využít moderní technologii AI a zároveň zůstat v souladu se svými podnikovými zásadami a respektující soukromí svých zákazníků.</span><span class="sxs-lookup"><span data-stu-id="24c19-115">Combining the edge and public cloud lets Contoso take advantage of modern AI technology while also remaining in compliance with their corporate policies and respecting their customers' privacy.</span></span>

<span data-ttu-id="24c19-116">[![Řešení Pattern Footfall Detection](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span><span class="sxs-lookup"><span data-stu-id="24c19-116">[![Footfall detection pattern solution](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span></span>

<span data-ttu-id="24c19-117">Tady je přehled toho, jak řešení funguje:</span><span class="sxs-lookup"><span data-stu-id="24c19-117">Here's a summary of how the solution works:</span></span>

1. <span data-ttu-id="24c19-118">Sada Custom Vision AI dev Kit Získá konfiguraci z IoT Hub, která nainstaluje IoT Edge modul runtime a model ML.</span><span class="sxs-lookup"><span data-stu-id="24c19-118">The Custom Vision AI Dev Kit gets a configuration from IoT Hub, which installs the IoT Edge Runtime and an ML model.</span></span>
2. <span data-ttu-id="24c19-119">Pokud se model dohlíží na osobu, převezme obrázek a nahraje ho pro Azure Stack úložiště objektů BLOB hub.</span><span class="sxs-lookup"><span data-stu-id="24c19-119">If the model sees a person, it takes a picture and uploads it to Azure Stack Hub blob storage.</span></span>
3. <span data-ttu-id="24c19-120">Služba BLOB Service aktivuje funkci Azure ve službě Azure Stack hub.</span><span class="sxs-lookup"><span data-stu-id="24c19-120">The blob service triggers an Azure Function on Azure Stack Hub.</span></span>
4. <span data-ttu-id="24c19-121">Funkce Azure volá kontejner s rozhraní API pro rozpoznávání tváře, aby získala data demografických a emoce z obrázku.</span><span class="sxs-lookup"><span data-stu-id="24c19-121">The Azure Function calls a container with the Face API to get demographic and emotion data from the image.</span></span>
5. <span data-ttu-id="24c19-122">Data se v clusteru Azure Event Hubs neodesílají a odešlou.</span><span class="sxs-lookup"><span data-stu-id="24c19-122">The data is anonymized and sent to an Azure Event Hubs cluster.</span></span>
6. <span data-ttu-id="24c19-123">Cluster Event Hubs zasune data do Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="24c19-123">The Event Hubs cluster pushes the data to Stream Analytics.</span></span>
7. <span data-ttu-id="24c19-124">Stream Analytics agreguje data a odešle je do Power BI.</span><span class="sxs-lookup"><span data-stu-id="24c19-124">Stream Analytics aggregates the data and pushes it to Power BI.</span></span>

## <a name="components"></a><span data-ttu-id="24c19-125">Komponenty</span><span class="sxs-lookup"><span data-stu-id="24c19-125">Components</span></span>

<span data-ttu-id="24c19-126">Toto řešení používá následující komponenty:</span><span class="sxs-lookup"><span data-stu-id="24c19-126">This solution uses the following components:</span></span>

| <span data-ttu-id="24c19-127">Vrstva</span><span class="sxs-lookup"><span data-stu-id="24c19-127">Layer</span></span> | <span data-ttu-id="24c19-128">Komponenta</span><span class="sxs-lookup"><span data-stu-id="24c19-128">Component</span></span> | <span data-ttu-id="24c19-129">Popis</span><span class="sxs-lookup"><span data-stu-id="24c19-129">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="24c19-130">Hardware v obchodě</span><span class="sxs-lookup"><span data-stu-id="24c19-130">In-store hardware</span></span> | [<span data-ttu-id="24c19-131">Custom Vision AI dev Kit</span><span class="sxs-lookup"><span data-stu-id="24c19-131">Custom Vision AI Dev Kit</span></span>](https://azure.github.io/Vision-AI-DevKit-Pages/) | <span data-ttu-id="24c19-132">Poskytuje filtrování in-Store pomocí místního modelu ML, který zachycuje jenom obrázky lidí pro účely analýzy.</span><span class="sxs-lookup"><span data-stu-id="24c19-132">Provides in-store filtering using a local ML model that only captures images of people for analysis.</span></span> <span data-ttu-id="24c19-133">Bezpečně zřízené a aktualizované prostřednictvím IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="24c19-133">Securely provisioned and updated through IoT Hub.</span></span><br><br>|
| <span data-ttu-id="24c19-134">Azure</span><span class="sxs-lookup"><span data-stu-id="24c19-134">Azure</span></span> | [<span data-ttu-id="24c19-135">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="24c19-135">Azure Event Hubs</span></span>](/azure/event-hubs/) | <span data-ttu-id="24c19-136">Azure Event Hubs poskytuje škálovatelnou platformu pro ingestování anonymních dat, která se v Azure Stream Analytics integrují s využitím.</span><span class="sxs-lookup"><span data-stu-id="24c19-136">Azure Event Hubs provides a scalable platform for ingesting anonymized data that integrates neatly with Azure Stream Analytics.</span></span> |
|  | [<span data-ttu-id="24c19-137">Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="24c19-137">Azure Stream Analytics</span></span>](/azure/stream-analytics/) | <span data-ttu-id="24c19-138">Úloha Azure Stream Analytics agreguje data a seskupuje je do 15 sekund Windows pro vizualizaci.</span><span class="sxs-lookup"><span data-stu-id="24c19-138">An Azure Stream Analytics job aggregates the anonymized data and groups it into 15-second windows for visualization.</span></span> |
|  | [<span data-ttu-id="24c19-139">Microsoft Power BI</span><span class="sxs-lookup"><span data-stu-id="24c19-139">Microsoft Power BI</span></span>](https://powerbi.microsoft.com/) | <span data-ttu-id="24c19-140">Power BI poskytuje snadno použitelné rozhraní řídicího panelu pro zobrazení výstupu z Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="24c19-140">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="24c19-141">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="24c19-141">Azure Stack Hub</span></span> | [<span data-ttu-id="24c19-142">App Service</span><span class="sxs-lookup"><span data-stu-id="24c19-142">App Service</span></span>](/azure-stack/operator/azure-stack-app-service-overview) | <span data-ttu-id="24c19-143">Poskytovatel prostředků App Service (RP) poskytuje základ pro komponenty Edge, včetně funkcí hostování a správy pro webové aplikace/rozhraní API a funkce.</span><span class="sxs-lookup"><span data-stu-id="24c19-143">The App Service resource provider (RP) provides a base for edge components, including hosting and management features for web apps/APIs and Functions.</span></span> |
| | <span data-ttu-id="24c19-144">Cluster [modulu AKS (](https://github.com/Azure/aks-engine) Azure Kubernetes Service)</span><span class="sxs-lookup"><span data-stu-id="24c19-144">Azure Kubernetes Service [(AKS) Engine](https://github.com/Azure/aks-engine) cluster</span></span> | <span data-ttu-id="24c19-145">AKS RP s AKS-Engine clusteru nasazeným do centra Azure Stack poskytuje škálovatelný a odolný modul pro spuštění kontejneru rozhraní API pro rozpoznávání tváře.</span><span class="sxs-lookup"><span data-stu-id="24c19-145">The AKS RP with AKS-Engine cluster deployed into Azure Stack Hub provides a scalable, resilient engine to run the Face API container.</span></span> |
| | <span data-ttu-id="24c19-146">[Kontejnery rozhraní API pro rozpoznávání tváře](/azure/cognitive-services/face/face-how-to-install-containers) Azure Cognitive Services</span><span class="sxs-lookup"><span data-stu-id="24c19-146">Azure Cognitive Services [Face API containers](/azure/cognitive-services/face/face-how-to-install-containers)</span></span>| <span data-ttu-id="24c19-147">Azure Cognitive Services RP s rozhraní API pro rozpoznávání tváře Containers poskytuje demografické, emoce a jedinečné zjišťování návštěvníků v privátní síti společnosti Contoso.</span><span class="sxs-lookup"><span data-stu-id="24c19-147">The Azure Cognitive Services RP with Face API containers provides demographic, emotion, and unique visitor detection on Contoso's private network.</span></span> |
| | <span data-ttu-id="24c19-148">Blob Storage</span><span class="sxs-lookup"><span data-stu-id="24c19-148">Blob Storage</span></span> | <span data-ttu-id="24c19-149">Image zachycené ze sady AI dev Kit se nahrají do úložiště objektů BLOB v centru Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="24c19-149">Images captured from the AI Dev Kit are uploaded to Azure Stack Hub's blob storage.</span></span> |
| | <span data-ttu-id="24c19-150">Azure Functions</span><span class="sxs-lookup"><span data-stu-id="24c19-150">Azure Functions</span></span> | <span data-ttu-id="24c19-151">Funkce Azure spuštěná v centru Azure Stack přijímá vstup z úložiště objektů BLOB a spravuje interakce s rozhraní API pro rozpoznávání tváře.</span><span class="sxs-lookup"><span data-stu-id="24c19-151">An Azure Function running on Azure Stack Hub receives input from blob storage and manages the interactions with the Face API.</span></span> <span data-ttu-id="24c19-152">Emituje data do clusteru Event Hubs umístěného v Azure.</span><span class="sxs-lookup"><span data-stu-id="24c19-152">It emits anonymized data to an Event Hubs cluster located in Azure.</span></span><br><br>|

## <a name="issues-and-considerations"></a><span data-ttu-id="24c19-153">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="24c19-153">Issues and considerations</span></span>

<span data-ttu-id="24c19-154">Při rozhodování, jak implementovat toto řešení, vezměte v úvahu následující body:</span><span class="sxs-lookup"><span data-stu-id="24c19-154">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="24c19-155">Škálovatelnost</span><span class="sxs-lookup"><span data-stu-id="24c19-155">Scalability</span></span>

<span data-ttu-id="24c19-156">Pokud chcete toto řešení povolit pro škálování napříč několika fotoaparáty a umístěními, musíte zajistit, aby všechny součásti mohly zpracovat zvýšené zatížení.</span><span class="sxs-lookup"><span data-stu-id="24c19-156">To enable this solution to scale across multiple cameras and locations, you'll need to make sure that all of the components can handle the increased load.</span></span> <span data-ttu-id="24c19-157">Možná budete muset provést následující akce:</span><span class="sxs-lookup"><span data-stu-id="24c19-157">You may need to take actions like:</span></span>

- <span data-ttu-id="24c19-158">Zvyšte počet Stream Analytics jednotek streamování.</span><span class="sxs-lookup"><span data-stu-id="24c19-158">Increase the number of Stream Analytics streaming units.</span></span>
- <span data-ttu-id="24c19-159">Horizontální navýšení kapacity rozhraní API pro rozpoznávání tváře nasazení.</span><span class="sxs-lookup"><span data-stu-id="24c19-159">Scale out the Face API deployment.</span></span>
- <span data-ttu-id="24c19-160">Zvyšte propustnost Event Hubs clusteru.</span><span class="sxs-lookup"><span data-stu-id="24c19-160">Increase the Event Hubs cluster throughput.</span></span>
- <span data-ttu-id="24c19-161">V extrémních případech může být potřeba migrovat z Azure Functions do virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="24c19-161">For extreme cases, migrate from Azure Functions to a virtual machine may be necessary.</span></span>

### <a name="availability"></a><span data-ttu-id="24c19-162">Dostupnost</span><span class="sxs-lookup"><span data-stu-id="24c19-162">Availability</span></span>

<span data-ttu-id="24c19-163">Vzhledem k tomu, že toto řešení je vrstveno, je důležité vzít v úvahu, jak řešit potíže se sítí nebo výpadky napájení.</span><span class="sxs-lookup"><span data-stu-id="24c19-163">Since this solution is tiered, it's important to think about how to deal with networking or power failures.</span></span> <span data-ttu-id="24c19-164">V závislosti na obchodních potřebách můžete chtít implementovat mechanismus pro místní ukládání imagí do mezipaměti a pak předána do centra Azure Stack, když se připojení vrátí.</span><span class="sxs-lookup"><span data-stu-id="24c19-164">Depending on business needs, you might want to implement a mechanism to cache images locally, then forward to Azure Stack Hub when connectivity returns.</span></span> <span data-ttu-id="24c19-165">Pokud je umístění dostatečně velké, může být lepší volbou nasazení Data Box Edge s kontejnerem rozhraní API pro rozpoznávání tváře do tohoto umístění.</span><span class="sxs-lookup"><span data-stu-id="24c19-165">If the location is large enough, deploying a Data Box Edge with the Face API container to that location might be a better option.</span></span>

### <a name="manageability"></a><span data-ttu-id="24c19-166">Možnosti správy</span><span class="sxs-lookup"><span data-stu-id="24c19-166">Manageability</span></span>

<span data-ttu-id="24c19-167">Toto řešení může zahrnovat mnoho zařízení a umístění, což by mohlo mít nepraktický.</span><span class="sxs-lookup"><span data-stu-id="24c19-167">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="24c19-168">[Služby IoT v Azure](/azure/iot-fundamentals/) je možné použít k automatickému uvedení nových umístění a zařízení do režimu online a jejich udržování v aktuálním stavu.</span><span class="sxs-lookup"><span data-stu-id="24c19-168">[Azure's IoT services](/azure/iot-fundamentals/) can be used to automatically bring new locations and devices online and keep them up to date.</span></span>

### <a name="security"></a><span data-ttu-id="24c19-169">Zabezpečení</span><span class="sxs-lookup"><span data-stu-id="24c19-169">Security</span></span>

<span data-ttu-id="24c19-170">Toto řešení zachycuje obrázky zákazníků a má jistotu na nejdůležitější aspekty.</span><span class="sxs-lookup"><span data-stu-id="24c19-170">This solution captures customer images, making security a paramount consideration.</span></span> <span data-ttu-id="24c19-171">Zajistěte, aby všechny účty úložiště byly zabezpečené se správnými zásadami přístupu a pravidelně střídat klíče.</span><span class="sxs-lookup"><span data-stu-id="24c19-171">Make sure all storage accounts are secured with the proper access policies and rotate keys regularly.</span></span> <span data-ttu-id="24c19-172">Ujistěte se, že účty úložiště a Event Hubs mají zásady uchovávání informací, které splňují předpisy pro ochranu osobních údajů podniku a vlády</span><span class="sxs-lookup"><span data-stu-id="24c19-172">Ensure storage accounts and Event Hubs have retention policies that meet corporate and government privacy regulations.</span></span> <span data-ttu-id="24c19-173">Také nezapomeňte nastavit úroveň přístupu uživatele.</span><span class="sxs-lookup"><span data-stu-id="24c19-173">Also make sure to tier the user access levels.</span></span> <span data-ttu-id="24c19-174">Vrstvení zajišťuje, že uživatelé mají přístup jenom k datům, která potřebují pro jejich roli.</span><span class="sxs-lookup"><span data-stu-id="24c19-174">Tiering ensures that users only have access to the data they need for their role.</span></span>

## <a name="next-steps"></a><span data-ttu-id="24c19-175">Další kroky</span><span class="sxs-lookup"><span data-stu-id="24c19-175">Next steps</span></span>

<span data-ttu-id="24c19-176">Další informace o tématech představených v tomto článku:</span><span class="sxs-lookup"><span data-stu-id="24c19-176">To learn more about the topics introduced in this article:</span></span>

- <span data-ttu-id="24c19-177">Podívejte se na [model vrstvené dat](https://aka.ms/tiereddatadeploy), který je vydaný vzorem detekce Footfall.</span><span class="sxs-lookup"><span data-stu-id="24c19-177">See the [Tiered Data pattern](https://aka.ms/tiereddatadeploy), which is leveraged by the footfall detection pattern.</span></span>
- <span data-ttu-id="24c19-178">Další informace o používání vlastní vize najdete v sadě [Custom Vision AI dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) .</span><span class="sxs-lookup"><span data-stu-id="24c19-178">See the [Custom Vision AI Dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) to learn more about using custom vision.</span></span> 

<span data-ttu-id="24c19-179">Až budete připraveni otestovat příklad řešení, pokračujte v [Průvodci nasazením Footfall Detection](solution-deployment-guide-retail-footfall-detection.md).</span><span class="sxs-lookup"><span data-stu-id="24c19-179">When you're ready to test the solution example, continue with the [Footfall detection deployment guide](solution-deployment-guide-retail-footfall-detection.md).</span></span> <span data-ttu-id="24c19-180">Průvodce nasazením poskytuje podrobné pokyny pro nasazení a testování jeho komponent.</span><span class="sxs-lookup"><span data-stu-id="24c19-180">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
